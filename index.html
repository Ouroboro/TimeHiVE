<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Time-series Hierarchical Visual Explorer • TimeHiVE</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Time-series Hierarchical Visual Explorer">
<meta name="description" content="Hierarchical moving-window statistical analysis for time series. A collection of utilities for moving averages, trends, and correlations analysis of time-series, including efficient implementations of statistical tests and visualization tools.">
<meta property="og:description" content="Hierarchical moving-window statistical analysis for time series. A collection of utilities for moving averages, trends, and correlations analysis of time-series, including efficient implementations of statistical tests and visualization tools.">
<script defer data-domain="github.org/Ouroboro" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">TimeHiVE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="https://github.com/Ouroboro/TimeHiVE/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="timehive-hierarchical-moving-window-time-series-analysis-toolkit">TimeHiVE: Hierarchical Moving-Window Time Series Analysis Toolkit<a class="anchor" aria-label="anchor" href="#timehive-hierarchical-moving-window-time-series-analysis-toolkit"></a>
</h1></div>
<!-- badges: start -->

<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>TimeHiVE provides efficient R functions for hierarchical moving-window analysis of coupled time series data. The toolkit implements:</p>
<ul>
<li>Parallel computation of Pearson and Mann-Kendall correlations</li>
<li>Optimized O(n log n) implementations of statistical tests</li>
<li>Customizable visualization of time-dependent relationships</li>
<li>Statistical significance testing with adjustable thresholds</li>
</ul>
<p>The software package here proposed allows to perform analyses on time series avoiding the arbitrary choice of the time window and allowing to appreciate the whole spectrum of possible results offered by this kind of statistical tools.</p>
<p><img src="reference/figures/Fig1.png" alt="Original Time Series"><em>Figure 1: Different Moving Average vs Original Syntetic Time Series. Color scale on y-axis is meant only to match colors in Fig. 2</em></p>
<p><img src="reference/figures/Fig2.png" alt="TimeHiVE Moving Average"><em>Figure 2: Representation of all the possible moving averages for the Original Syntetic Time Series, moving averages analyses represented in Fig. 1 are highlighted with comments on the results.</em></p>
<p><img src="reference/figures/Fig3.png" alt="Original Coupled Series"><em>Figure 3: Representation of two Time Series positively correlated for short periods but negatively correlated for long periods. The series are built as: <code>TS1 = 40 + 2*sin(t/2) - t/20 - rand(-2/3, 2/3)</code> and <code>TS2 = 15 + 2*sin(t/2) + t/7 - rand(-2/3, 2/3)</code>. The sine component creates short-term positive correlation, while the <code>t/n</code> terms drive long-term negative correlation.</em></p>
<p><img src="reference/figures/Fig4.png" alt="Original Time Series"><em>Figure 4: Here we show the Moving Correlation Analysis for the coupled Time Series represented in Fig. 4, the first row shows the results for Pearson’s correlation coefficient (Top Left) and relative p-values (Top Right), the second row shows the same analysis with MK’s correlation coefficients (Bottom Left) and relative p-values (Bottom Right). The inversion of the correlation between short and long period of analysis is quite clear.</em></p>
<p>FIRST ROW: Pearson’s correlation coefficient (Top Left) and relative p-values (Top Right). SECOND ROW: same analysis with MK’s correlation coefficientes (Bottom Left) and relative p-values (Bottom Right). The inversion of the correlation between short and long period of analysis is quite clear.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version from GitHub with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"Ouroboro/TimeHiVE"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<div class="section level3">
<h3 id="basic-example">Basic Example<a class="anchor" aria-label="anchor" href="#basic-example"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Ouroboro/TimeHiVE">TimeHiVE</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate example data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">series1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">*</span><span class="va">pi</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">200</span>, sd <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">series2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">*</span><span class="va">pi</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">200</span>, sd <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform analysis</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/TH_coupled.html">TH_coupled</a></span><span class="op">(</span></span>
<span>  series1 <span class="op">=</span> <span class="va">series1</span>,</span>
<span>  series2 <span class="op">=</span> <span class="va">series2</span>,</span>
<span>  m <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  s <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"both"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize results</span></span>
<span><span class="fu"><a href="reference/TH_plotc.html">TH_plotc</a></span><span class="op">(</span><span class="va">results</span>, mask <span class="op">=</span> <span class="cn">TRUE</span>, mode <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="advanced-usage">Advanced Usage<a class="anchor" aria-label="anchor" href="#advanced-usage"></a>
</h3>
<p>For functions <code>TH_plots</code> and <code>TH_plotc</code>, you can use significance values to mask the output of statistical tests depending on the value you chose previously.</p>
<pre><code><span><span class="va">results2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/TH_coupled.html">TH_coupled</a></span><span class="op">(</span><span class="va">series1</span>, <span class="va">series2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Fig5</span> <span class="op">&lt;-</span> <span class="st">"Fig5.png"</span></span>
<span><span class="va">Fig6</span> <span class="op">&lt;-</span> <span class="st">"Fig6.png"</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/TH_plotc.html">TH_plotc</a></span><span class="op">(</span><span class="va">results2</span>, output_file <span class="op">=</span> <span class="va">Fig5</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/TH_plotc.html">TH_plotc</a></span><span class="op">(</span><span class="va">results2</span>, output_file <span class="op">=</span> <span class="va">Fig6</span>, mask <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
<p><img src="reference/figures/Fig5.png" alt="Unmasked"><em>Output for Fig. 5 unmasked.</em></p>
<p><img src="reference/figures/Fig6.png" alt="Masked"><em>Output for Fig. 6 masked.</em></p>
<p>If the moving-window statistical analyses proposed by the previous functions are not sufficient, functions <code><a href="reference/TH_tweak.html">TH_tweak()</a></code> and <code><a href="reference/TH_plott.html">TH_plott()</a></code> allow you to use custom functions and possibly customize the color scales and tile intervals during the display phase. An exhaustive example follows shortly.</p>
<pre><code><span><span class="co">### START Customized Functions ###</span></span>
<span></span>
<span><span class="va">harmean_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">series</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">series</span> <span class="op">&lt;-</span> <span class="va">series</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">series</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">series</span><span class="op">)</span></span>
<span>  <span class="va">sol</span> <span class="op">&lt;-</span> <span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">series</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">mean_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="va">diffmean_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">series</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">series</span> <span class="op">&lt;-</span> <span class="va">series</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">series</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">harmean_fun</span><span class="op">(</span><span class="va">series</span><span class="op">)</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">mean_fun</span><span class="op">(</span><span class="va">series</span><span class="op">)</span></span>
<span>  <span class="va">sol</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">-</span><span class="va">y</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">skew_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">series</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">series</span> <span class="op">&lt;-</span> <span class="va">series</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">series</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">series</span><span class="op">)</span></span>
<span>  <span class="va">avg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">series</span><span class="op">)</span></span>
<span>  <span class="va">sd_camp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">series</span><span class="op">)</span></span>
<span>  <span class="va">sol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">series</span> <span class="op">-</span> <span class="va">avg</span><span class="op">)</span><span class="op">^</span><span class="fl">3</span> <span class="op">/</span> <span class="op">(</span><span class="va">sd_camp</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">### END Customized Functions ###</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/TH_tweak.html">TH_tweak</a></span><span class="op">(</span></span>
<span>  <span class="va">harmean_fun</span>,</span>
<span>  <span class="va">mean_fun</span>,</span>
<span>  <span class="va">diffmean_fun</span>,</span>
<span>  <span class="va">skew_fun</span>,</span>
<span>  series <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,</span>
<span>  param <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">### START Customized Color Palette ###</span></span>
<span></span>
<span><span class="va">skew</span> <span class="op">=</span> <span class="op">{</span></span>
<span>  <span class="va">neg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"green4"</span>, <span class="st">"green"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">33</span><span class="op">)</span></span>
<span>  <span class="va">pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"magenta"</span>, <span class="st">"magenta4"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">33</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">neg</span>, <span class="st">"white"</span>, <span class="va">pos</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">### END Customized Color Palette ###</span></span>
<span></span>
<span><span class="va">Fig7</span> <span class="op">&lt;-</span> <span class="st">"Fig7.png"</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/TH_plott.html">TH_plott</a></span><span class="op">(</span><span class="va">results</span>, output_file <span class="op">=</span> <span class="va">Fig7</span>,</span>
<span>              colorscales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                <span class="st">"avg"</span>,</span>
<span>                <span class="st">"avg"</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"magenta"</span>, <span class="st">"purple"</span>, <span class="st">"blue"</span>, <span class="st">"cyan"</span>, <span class="st">"white"</span><span class="op">)</span>,</span>
<span>                <span class="va">skew</span><span class="op">)</span>,</span>
<span>              colorlimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">35</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">35</span><span class="op">)</span>,</span>
<span>                <span class="cn">NULL</span>,</span>
<span>                <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<p><img src="reference/figures/Fig7.png" alt="Single Series Tweak"><em>Output for Fig. 7 single series tweak.</em></p>
<pre><code><span><span class="co">### START Customized Functions ###</span></span>
<span></span>
<span><span class="va">pearson_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span><span class="op">$</span><span class="va">estimate</span></span>
<span></span>
<span><span class="va">diffmax_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">serie1</span>, <span class="va">serie2</span>, <span class="va">na.rm</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">max1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">serie1</span>, na.rm <span class="op">=</span> <span class="va">na.rm</span><span class="op">)</span></span>
<span>  <span class="va">max2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">serie2</span>, na.rm <span class="op">=</span> <span class="va">na.rm</span><span class="op">)</span></span>
<span>  <span class="va">sol</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">max1</span><span class="op">-</span><span class="va">max2</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">sqrmean_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">serie1</span>, <span class="va">serie2</span>, <span class="va">na.rm</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">serie1</span>, na.rm <span class="op">=</span> <span class="va">na.rm</span><span class="op">)</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">serie2</span>, na.rm <span class="op">=</span> <span class="va">na.rm</span><span class="op">)</span></span>
<span>  <span class="va">sol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span><span class="op">*</span><span class="va">y</span><span class="op">)</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">### END Customized Functions ###</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/TH_tweak.html">TH_tweak</a></span><span class="op">(</span></span>
<span>  <span class="va">pearson_fun</span>,</span>
<span>  <span class="va">diffmax_fun</span>,</span>
<span>  <span class="va">sqrmean_fun</span>,</span>
<span>  series <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">sdata</span>, <span class="va">sdata2</span><span class="op">)</span>,</span>
<span>  param <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">Fig8</span> <span class="op">&lt;-</span> <span class="st">"Fig8.png"</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/TH_plott.html">TH_plott</a></span><span class="op">(</span><span class="va">results</span>, output_file <span class="op">=</span> <span class="va">Fig8</span>,</span>
<span>colorscales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"white"</span>, <span class="st">"red"</span><span class="op">)</span>,</span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"yellow"</span>, <span class="st">"purple"</span><span class="op">)</span>,</span>
<span>                   <span class="st">"avg"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<p><img src="reference/figures/Fig8.png" alt="Coupled Series Tweak"><em>Output for Fig. 8 coupled series tweak.</em></p>
</div>
<div class="section level3">
<h3 id="main-functions">Main Functions<a class="anchor" aria-label="anchor" href="#main-functions"></a>
</h3>
<ul>
<li>
<code><a href="reference/TH_single.html">TH_single()</a></code>: Perform hierarchical moving-window analysis for single series</li>
<li>
<code><a href="reference/TH_coupled.html">TH_coupled()</a></code>: Perform hierarchical moving-window analysis for coupled series</li>
<li>
<code><a href="reference/TH_tweak.html">TH_tweak()</a></code>: Perform customized hierarchical moving-window analysis for coupled or single series</li>
<li>
<code><a href="reference/TH_plots.html">TH_plots()</a></code>: Visualize analysis results from <code><a href="reference/TH_single.html">TH_single()</a></code>
</li>
<li>
<code><a href="reference/TH_plotc.html">TH_plotc()</a></code>: Visualize analysis results from <code><a href="reference/TH_coupled.html">TH_coupled()</a></code>
</li>
<li>
<code><a href="reference/TH_plott.html">TH_plott()</a></code>: Visualize analysis results from <code><a href="reference/TH_tweak.html">TH_tweak()</a></code>, no masking.</li>
<li>
<code><a href="reference/TH_MK_Trend.html">TH_MK_Trend()</a></code>: Mann-Kendall trend test</li>
<li>
<code><a href="reference/TH_MK_Corr.html">TH_MK_Corr()</a></code>: Mann-Kendall correlation test</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h2>
<p>For detailed documentation see:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">TH_single</span></span>
<span><span class="op">?</span><span class="va">TH_coupled</span></span>
<span><span class="op">?</span><span class="va">TH_tweak</span></span>
<span><span class="op">?</span><span class="va">TH_plots</span></span>
<span><span class="op">?</span><span class="va">TH_plotc</span></span>
<span><span class="op">?</span><span class="va">TH_plott</span></span>
<span><span class="op">?</span><span class="va">TH_MK_Trend</span></span>
<span><span class="op">?</span><span class="va">TH_MK_Corr</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h2>
<p>Contributions are welcome! Please follow these steps:</p>
<ol style="list-style-type: decimal">
<li>Fork the repository</li>
<li>Create your feature branch (<code>git checkout -b feature/your-feature</code>)</li>
<li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li>
<li>Push to the branch (<code>git push origin feature/your-feature</code>)</li>
<li>Open a Pull Request</li>
</ol>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>This package is licensed under the GNU General Public License v3.0 (GPL-3.0). See the <a href="LICENSE">LICENSE</a> file for details.</p>
</div>
<div class="section level2">
<h2 id="contact">Contact<a class="anchor" aria-label="anchor" href="#contact"></a>
</h2>
<p>For questions or issues, please contact:</p>
<p>Vladimiro Andrea Boselli<br>
Email: <a href="mailto:boselli.v@irea.cnr.it" class="email">boselli.v@irea.cnr.it</a><br>
GitHub: <a href="https://github.com/Ouroboro" class="external-link">@Ouroboro</a></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/Ouroboro/TimeHiVE/">Browse source code</a></li>
<li><a href="https://github.com/Ouroboro/TimeHiVE/issues">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a>.0-or-later</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing TimeHiVE</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Vladimiro Andrea Boselli <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0003-2985-6358" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Paolo Tagliolato Acquaviva d'Aragona <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-0261-313X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Alessandro Oggioni <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-7997-219X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.gnu.org/licenses/gpl-3.0" class="external-link"><img src="https://img.shields.io/badge/License-GPLv3-blue.svg" alt="License: GPL v3"></a></li>
<li><a href="https://doi.org/10.5281/zenodo.15697261" class="external-link"><img src="https://img.shields.io/badge/doi-10.5281/zenodo.15697261-yellow.svg" alt="DOI: 10.5281/zenodo.15697261"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vladimiro Andrea Boselli, Paolo Tagliolato Acquaviva d’Aragona, Alessandro Oggioni.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
